## Загрузка классов

Некоторые базовые классы из rt.jar (например, java.lang.*) загружаются при старте приложения. Остальные классы
загружаются по мере необходимости.

Загрузчики классов:
1. Bootstrap - базовый загрузчик;
2. Extension - загрузчик расширений;
3. Application or System - системный загрузчик:
   1) все создаваемые в программе загрузчики должны наследоваться от java.lang.ClassLoader.

Метод `ИмяКласса.class.getClassLoader()` используется для того, чтобы получить загрузчик, которым был загружен класс.

## Bootstrap
Реализован на уровне JVM и не имеет обратной связи со средой исполнения. Bootstrap ClassLoader отвечает за
загрузку внутренних классов JDK. По сути, это машинный код, который запускает операцию, когда JVM вызывает ее и
загружает классы из rt.jar. Вызов метода getClassLoader() у классов java.* всегда возвращает null. Это объясняется
именно тем, что все базовые классы загружены базовым загрузчиком, доступа к которому из управляемой среды нет.

## Extension
Загрузчик расширений. Данный загрузчик загружает классы из директории $JAVA_HOME/lib/ext. Загружает расширения основных классов Java из библиотеки расширений JDK.

## Application or System
Системный загрузчик, реализованный уже на уровне JRE. Этот тип загружает все классы уровня приложения.

Принципы работы системы загрузки классов:
1. Уникальность - все классы являются уникальными, классы, загружаемые родительским ClassLoader, не загружаются дочерним.
2. [Делегирование](img/classloading.png) - когда генерируется запрос на поиск класса, экземпляр ClassLoader делегирует поиск родительскому загрузчику. 
   1) JVM генерирует запрос на поиск класса, когда сталкивается с ним; 
   2) Управление переходит Application ClassLoader, который ищет класс в своем кеше, если класс загружался ранее, то загрузчик возвращает его из кеша;
   3) Если не находит, Application делегирует запрос Extension, который ищет класс в своем кеше, если класс загружался ранее, то загрузчик возвращает его из кеша; 
   4) Если не находит, Extension делегирует запрос Bootstrap, который ищет класс в своем кеше, если класс загружался ранее, то загрузчик возвращает его из кеша;
   5) Если не находит, Bootstrap проверяет доступен ему данный класс или нет; 
   6) Если класс доступен Bootstrap, он загружается и сохраняется в кеше;
   7) Если класс не доступен, Bootstrap снова передает запрос в Extension;
   8) Extension проверяет доступен ему данный класс или нет и т.д.;
   9) Если запрос дошел до Application и он не смог загрузить класс, генерируется исключение ClassNotFoundException.

3. Принцип видимости - классы, загруженные Application Classloader, видны классам, загруженным Extension и Bootstrap
   Classloader, но не наоборот.

